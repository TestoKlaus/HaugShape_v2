% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca_saturation.R
\name{compute_pca_saturation}
\alias{compute_pca_saturation}
\title{Compute PCA Saturation Curve}
\usage{
compute_pca_saturation(
  pca_object,
  sample_sizes = seq(0.1, 1, 0.1),
  bootstrap_iterations = 200,
  pcs_to_analyze = NULL,
  metric = c("total_variance", "cumulative_variance"),
  min_sample_size = 5,
  seed = NULL,
  parallel = FALSE,
  n_cores = NULL
)
}
\arguments{
\item{pca_object}{A PCA object (from PCA() function) or a matrix of PC scores}

\item{sample_sizes}{Numeric vector of sample sizes to test. Can be absolute numbers
or proportions (0-1). Default: seq(0.1, 1, 0.1) for 10%, 20%, ..., 100%}

\item{bootstrap_iterations}{Number of bootstrap resampling iterations per sample size.
Default: 200}

\item{pcs_to_analyze}{Number of principal components to include in analysis.
Default: NULL (uses all available PCs with non-zero variance)}

\item{metric}{Variance metric to compute. Options: "total_variance", "pc1_variance",
"cumulative_variance". Default: c("total_variance", "cumulative_variance")}

\item{min_sample_size}{Minimum sample size to test. Default: 5}

\item{seed}{Random seed for reproducibility. Default: NULL}

\item{parallel}{Use parallel processing for bootstrap. Default: FALSE}

\item{n_cores}{Number of cores for parallel processing. Default: NULL (uses all available - 1)}
}
\value{
A list with two elements:
  \item{saturation_data}{Data frame with columns: sample_size, metric_type, mean, median, sd, q025, q975}
  \item{parameters}{List of analysis parameters used}
}
\description{
Analyzes whether the morphospace is saturated by calculating variance metrics
across different sample sizes using bootstrap resampling. This helps determine
if adding new specimens will likely expand the morphospace.
}
\examples{
\dontrun{
# Load PCA results
pca_result <- readRDS("pca_analysis.rds")

# Compute saturation curve
saturation <- compute_pca_saturation(
  pca_result,
  sample_sizes = seq(0.1, 1, 0.1),
  bootstrap_iterations = 200
)

# Plot results
plot_pca_saturation(saturation)
}
}
