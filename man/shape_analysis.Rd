% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/shape_analysis.R
\name{shape_analysis}
\alias{shape_analysis}
\title{Analyze Shape Images and Perform PCA}
\usage{
shape_analysis(
  shape_dir,
  norm = TRUE,
  output_dir = NULL,
  output_file = "shape_analysis.xlsx",
  num_pcs = 10,
  start_point = "left",
  harmonics = NULL,
  align_orientation = FALSE,
  use_raw_shapes = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{shape_dir}{A character string specifying the directory containing shape files
(images in JPG format). The directory must exist and contain at least one valid JPG file.}

\item{norm}{Logical. Should the Fourier descriptors be normalized? If TRUE, shapes are
normalized to the first harmonic. If FALSE, shapes are normalized to the longest radius.
Default is TRUE.}

\item{output_dir}{A character string specifying the directory where the Excel file will be saved.
If NULL, the file will be saved in the working directory.}

\item{output_file}{A character string specifying the name of the Excel file where PCA scores will
be saved. Default is "shape_analysis.xlsx".}

\item{num_pcs}{Integer. The number of principal components to display in the PC contribution plot.
Must be between 1 and 50. Default is 10.}

\item{start_point}{A character string specifying the starting point for alignment during shape
normalization. Options are "up", "left", "down", or "right". Default is "left".}

\item{harmonics}{Integer. Number of harmonics to use for EFA. Default is NULL (automatic).}

\item{verbose}{Logical. Should progress messages be printed? Default is TRUE.}
}
\value{
A list containing:
  \describe{
    \item{pca_results}{The PCA object from Momocs}
    \item{scores}{Data frame of PCA scores}
    \item{summary}{Character string of PCA summary}
    \item{output_path}{Path where Excel results were saved}
    \item{summary_txt_path}{Path to saved PCA summary .txt file}
    \item{pc_plot_jpg_path}{Path to saved PC contributions .jpg}
    \item{metadata}{List of analysis metadata (n_shapes, harmonics, etc.)}
  }
}
\description{
This function processes a directory of shape images, normalizes the shapes,
performs Elliptical Fourier Analysis (EFA) and Principal Component Analysis (PCA),
displays a plot of PC contributions, and saves PCA scores to an Excel file.
}
\details{
The function uses the `Momocs` package to import, normalize, and analyze shape outlines:
- **Import**: Reads JPG/JPEG files and converts to shape outlines
- **Normalization**: Centers, scales, and aligns shapes to consistent orientation
- **Elliptical Fourier Analysis (EFA)**: Generates Fourier descriptors for the shape outlines
- **Principal Component Analysis (PCA)**: Decomposes Fourier descriptors into principal components

PCA scores for all analyzed shapes are saved to an Excel file. A plot of the contributions of the
specified number of principal components is displayed.
}
\section{Dependencies}{

This function requires the following R packages:
- \pkg{Momocs} for shape analysis
- \pkg{openxlsx} for writing PCA scores to an Excel file
}

\examples{
\dontrun{
# Basic shape analysis
result <- shape_analysis(
  shape_dir = "path/to/shape/directory",
  output_file = "my_analysis.xlsx"
)

# Advanced analysis with custom parameters
result <- shape_analysis(
  shape_dir = "path/to/shape/directory",
  norm = TRUE,
  output_dir = "path/to/output/directory",
  output_file = "shape_analysis_results.xlsx",
  num_pcs = 5,
  start_point = "down",
  harmonics = 20,
  verbose = TRUE
)

# Access results
print(result$summary)
head(result$scores)
}

}
